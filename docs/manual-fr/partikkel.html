<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>partikkel</title>
    <link rel="stylesheet" type="text/css" href="csound.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
    <link rel="home" href="index.html" title="Manuel de référence canonique de Csound" />
    <link rel="up" href="OpcodesTop.html" title="Opcodes et opérateurs de l'orchestre" />
    <link rel="prev" href="partials.html" title="partials" />
    <link rel="next" href="partikkelsync.html" title="partikkelsync" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">partikkel</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="partials.html">Précédent</a> </td>
          <th width="60%" align="center">Opcodes et opérateurs de l'orchestre</th>
          <td width="20%" align="right"> <a accesskey="n" href="partikkelsync.html">Suivant</a></td>
        </tr>
      </table>
      <hr />
    </div>
    <div class="refentry">
      <a id="partikkel"></a>
      <div class="titlepage"></div>
      <a id="IndexPartikkel" class="indexterm"></a>
      <div class="refnamediv">
        <h2>
          <span class="refentrytitle">partikkel</span>
        </h2>
        <p>partikkel — 
      Synthétiseur granulaire avec un contrôle "par grain" grâce à ses nombreux paramètres. Il
      a une entrée sync pour synchroniser son horloge interne de distribution des grains avec une
      horloge externe.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm47887650245760"></a>
        <h2>Description</h2>
        <p>
      <span class="emphasis"><em>partikkel</em></span> a été conçu après la lecture du livre de Curtis Road
      "Microsound", et le but était de créer un opcode capable de réaliser toutes les variétés
      temporelles de synthèse granulaire décrites dans ce livre. L'idée étant que la plupart des
      techniques ne diffèrent que par les valeurs des paramètres, et que si l'on a un opcode unique
      qui peut produire toutes les variétés de synthèse granulaire, l'interpolation entre ces
      techniques devient possible. La synthèse granulaire est parfois appelée synthèse par particules
      et il m'a semblé approprié de nommer l'opcode <span class="emphasis"><em>partikkel</em></span> afin de le
      distinguer des autres opcodes granulaires.
    </p>
        <p>
      Certains des paramètres d'entrée de <span class="emphasis"><em>partikkel</em></span> sont des numéros de table,
      pointant sur des tables dans lesquelles sont mémorisées des valeurs pour les changements de
      paramètre "par grain". <span class="emphasis"><em>partikkel</em></span> peut utiliser une période d'une forme
      d'onde ou des formes d'onde complexes (par exemple un son échantillonné) comme source de
      forme d'onde pour les grains. Chaque grain est constitué du mélange de 4 formes d'onde source.
      On peut accorder séparément la fréquence de base de chacune des 4 formes d'onde source. La
      modulation de fréquence à l'intérieur de chaque grain est activée via une entrée audio
      auxiliaire (<span class="emphasis"><em>awavfm</em></span>). La synthèse par trainlet (un trainlet est un bref
      train d'impulsions) est possible, et les trainlets peuvent être mélangés avec des grains basés
      sur des tables d'onde. On peut utiliser jusqu'à 8 sorties audio séparées.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm47887650165888"></a>
        <h2>Syntaxe</h2>
        <pre class="synopsis">a1 [, a2, a3, a4, a5, a6, a7, a8] <span class="command"><strong>partikkel</strong></span> agrainfreq, \
              kdistribution, idisttab, async, kenv2amt, ienv2tab, ienv_attack, \
              ienv_decay, ksustain_amount, ka_d_ratio, kduration, kamp, igainmasks, \
              kwavfreq, ksweepshape, iwavfreqstarttab, iwavfreqendtab, awavfm, \
              ifmamptab, kfmenv, icosine, ktraincps, knumpartials, kchroma, \
              ichannelmasks, krandommask, kwaveform1, kwaveform2, kwaveform3, \
              kwaveform4, iwaveamptab, asamplepos1, asamplepos2, asamplepos3, \
              asamplepos4, kwavekey1, kwavekey2, kwavekey3, kwavekey4, imax_grains \
              [, iopcode_id]</pre>
      </div>
      <div class="refsect1">
        <a id="idm47887650163248"></a>
        <h2>Initialisation</h2>
        <p>
      <span class="emphasis"><em>idisttab</em></span> -- numéro d'une table de fonction, distribution des
      déplacements aléatoires du grain dans le temps. Les valeurs de la table sont interprétées
      comme la "quantité de déplacement" pondérée par 1/(rythme des grains). Cela signifie qu'une
      valeur de 0,5 dans la table déplacera un grain de la moitié de la période du rythme des
      grains. Les valeurs de la table sont lues aléatoirement, et pondérées par
      <span class="emphasis"><em>kdistribution</em></span>. Pour obtenir des résultats stochastiques réalistes, il
      vaut mieux ne pas utiliser une taille de table trop petite, car cela limite le nombre des
      valeurs de déplacement possibles. On peut l'exploiter à d'autres fins, par exemple utiliser
      des valeurs de déplacement quantifiées pour travailler avec des décalages contrôlés à partir
      de la période du rythme des grains. Si <span class="emphasis"><em>kdistribution</em></span> est négatif, les
      valeurs de la table seront lues séquentiellement. On peut sélectionner une table par défaut
      au moyen du numéro de table -1, pour lequel <span class="emphasis"><em>idisttab</em></span> fournit une
      distribution nulle (pas de déplacement).
    </p>
        <p>
      <span class="emphasis"><em>ienv_attack</em></span> -- numéro d'une table de fonction, forme de l'attaque du
      grain. Il faut un point de garde d'extension. On peut choisir une table par défaut en utilisant
      -1 comme numéro de ftable, pour lequel <span class="emphasis"><em>ienv_attack</em></span> fournit une fenêtre
      rectangulaire (pas d'enveloppe).
    </p>
        <p>
      <span class="emphasis"><em>ienv_decay</em></span> -- numéro d'une table de fonction, forme de la chute du
      grain. Il faut un point de garde d'extension. On peut choisir une table par défaut en utilisant
      -1 comme numéro de ftable, pour lequel <span class="emphasis"><em>ienv_decay</em></span> fournit une fenêtre
      rectangulaire (pas d'enveloppe).
    </p>
        <p>
      <span class="emphasis"><em>ienv2tab</em></span> -- numéro d'une table de fonction, enveloppe additionnelle
      appliquée au grain après les enveloppes d'attaque et de chute. On peut l'utiliser par exemple
      pour la synthèse par formant fof. Il faut un point de garde d'extension. On peut choisir une
      table par défaut en utilisant -1 comme numéro de ftable, pour lequel
      <span class="emphasis"><em>ienv2tab</em></span> fournit une fenêtre rectangulaire (pas d'enveloppe).
    </p>
        <p>
      <span class="emphasis"><em>icosine</em></span> -- numéro d'une table de fonction, devant contenir un cosinus,
      utilisée pour les trainlets. La table doit avoir une taille d'au moins 2048 pour obtenir des
      trainlets de bonne qualité.
    </p>
        <p>
      <span class="emphasis"><em>igainmasks</em></span> -- numéro d'une table de fonction, gain par grain. La suite
      des valeurs dans la table a la signification suivante : la valeur d'indice 0 est le point de
      début d'une boucle de lecture des valeurs, la valeur d'indice 1 étant le point de fin de
      cette boucle. Les entrées aux autres indices contiennent les valeurs de gain (normalement
      dans l'intervalle 0 - 1, mais d'autres valeurs sont permises, les valeurs négatives inversant
      la phase de la forme d'onde du grain) pour une suite de grains ; ces valeurs sont lues au
      rythme des grains, ce qui permet une correspondance exacte de "gain par grain". Les points du
      début et de la fin de la boucle sont basés sur zéro avec une origine à l'indice 2, par
      exemple une valeur de début de boucle de 0 et une valeur de fin de boucle de 3 provoqueront
      la lecture des valeurs d'indice 2, 3, 4, 5 dans une boucle évoluant au rythme des grains. On
      peut choisir une table par défaut en utilisant -1 comme numéro de ftable, pour lequel
      <span class="emphasis"><em>igainmasks</em></span> désactive le masquage du gain (tous les grains reçoivent un
      masque de gain égal à 1).
    </p>
        <p>
      <span class="emphasis"><em>ichannelmasks</em></span> -- numéro d'une table de fonction, voir
      <span class="emphasis"><em>igainmasks</em></span> pour une description de la façon dont les valeurs sont lues
      dans la table. L'intervalle des valeurs va de 0 à N, où N est le nombre de canaux de sortie
      moins 1. Une valeur de zéro enverra le grain sur la sortie audio 1 de l'opcode. On peut
      utiliser des valeurs non entières, par exemple 3,5 répartira le grain également entre les
      sorties 4 et 5. L'utilisateur doit éviter les dépassements de niveau, aucun test n'étant
      effectué. L'opcode plantera si des valeurs dépassent le niveau maximal. On peut choisir une
      table par défaut en utilisant -1 comme numéro de ftable, pour lequel
      <span class="emphasis"><em>ichannelmasks</em></span> désactive le masquage des canaux (tous les grains reçoivent
      un masque de canal de 0 et sont envoyés sur la sortie audio 1 de
      <span class="emphasis"><em>partikkel</em></span>). 
    </p>
        <p>
      <span class="emphasis"><em>iwavfreqstarttab</em></span> -- numéro d'une table de fonction, voir
      <span class="emphasis"><em>igainmasks</em></span> pour une description de la façon dont les valeurs sont lues
      dans la table. Multiplicateur de la fréquence de départ de chaque grain. La hauteur glissera
      de la fréquence de départ jusqu'à la fréquence de fin suivant une droite ou une courbe fixée
      par <span class="emphasis"><em>ksweepshape</em></span>. On peut choisir une table par défaut en utilisant -1
      comme numéro de ftable, pour lequel <span class="emphasis"><em>iwavfreqstarttab</em></span> fournit un
      multiplicateur de 1, désactivant toute modification de la fréquence de départ.
    </p>
        <p>
      <span class="emphasis"><em>iwavfreqendtab</em></span> -- numéro d'une table de fonction, voir
      <span class="emphasis"><em>iwavfreqstarttab</em></span>. Multiplicateur de la fréquence de fin de chaque grain.
      On peut choisir une table par défaut en utilisant -1 comme numéro de ftable, pour lequel 
      <span class="emphasis"><em>iwavfreqendtab</em></span> fournit un multiplicateur de 1, désactivant toute
      modification de la fréquence de fin. 
    </p>
        <p>
      <span class="emphasis"><em>ifmamptab</em></span> -- numéro d'une table de fonction, voir
      <span class="emphasis"><em>igainmasks</em></span> pour une description de la façon dont les valeurs sont lues
      dans la table. Indice de modulation de fréquence par grain. Le signal
      <span class="emphasis"><em>awavfm</em></span> sera multiplié par les valeurs lues dans cette table. On peut
      choisir une table par défaut en utilisant -1 comme numéro de ftable, pour lequel
      <span class="emphasis"><em>ifmamptab</em></span> fournit 1 comme indice de modulation, activant la modulation
      de fréquence pour tous les grains.
    </p>
        <p>
      <span class="emphasis"><em>iwaveamptab</em></span> -- numéro d'une table de fonction, les indices sont parcourus
      de la même manière que pour <span class="emphasis"><em>igainmasks</em></span>. La valeur d'indice 0 sert de
      point de début de boucle et la valeur d'indice 1 de point de fin. Les autres indices sont lus
      par groupes de 5, dans lesquels chaque valeur représente une valeur de gain pour chacune des
      4 formes d'onde source, et la cinquième valeur représente l'amplitude de trainlet. On peut
      choisir une table par défaut en utilisant -1 comme numéro de ftable, pour lequel
      <span class="emphasis"><em>iwaveamptab</em></span> fournit un mélange égal des 4 formes d'onde source (chacune
      avec une amplitude de 0,5) et une amplitude de trainlet nulle.
    </p>
        <p>
      Le calcul des trainlets étant très gourmand en ressources CPU, on peut éviter la
      plupart des calculs de trainlet en fixant <span class="emphasis"><em>ktrainamp</em></span> à zéro. Les trainlets
      sont normalisés au niveau de crête (<span class="emphasis"><em>ktrainamp</em></span>), en compensation des
      variations d'amplitude causées par les variations de <span class="emphasis"><em>kpartials</em></span> et de
      <span class="emphasis"><em>kchroma</em></span>. 
    </p>
        <p>
      <span class="emphasis"><em>imax_grains</em></span> -- nombre maximum de grains par k-periode. Une grande valeur
      ne devrait pas affecter l'exécution, le dépassement de cette valeur conduira à l'effacement
      des grains les "plus anciens".
    </p>
        <p>
      <span class="emphasis"><em>iopcode_id</em></span> -- identificateur de l'opcode, liant une instance de
      <span class="emphasis"><em>partikkel</em></span> à une instance de
      <a class="link" href="partikkelsync.html" title="partikkelsync"><em class="citetitle">partikkelsync</em></a>, laquelle fournira
      en sortie des impulsions de déclenchement synchronisées pour le distributeur de grains de
      <span class="emphasis"><em>partikkel</em></span>. La valeur par défaut est zéro, ce qui signifie aucune
      connexion à une instance de <span class="emphasis"><em>partikkelsync</em></span>.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm47887650126464"></a>
        <h2>Exécution</h2>
        <p>
      <span class="emphasis"><em>xgrainfreq</em></span> -- nombre de grains par seconde. On peut spécifier une valeur
      nulle, ce qui déléguera la distribution des grains à l'entrée de synchronisation.
    </p>
        <p>
      <span class="emphasis"><em>async</em></span> -- entrée de synchronisation. Les valeurs entrées sont ajoutées à
      la phase de l'horloge interne du distributeur de grains, ce qui permet une synchronisation de
      tempo avec une horloge externe. Comme c'est un signal de taux-a, les entrées sont généralement
      des impulsions de longueur 1/<span class="emphasis"><em>sr</em></span>. A l'aide de telles impulsions on peut
      "faire bouger" la phase interne en avant ou en arrière, ce qui permet une synchronisation
      plus ou moins forte. Des valeurs d'entrée négatives décrémentent la phase interne, tandis que
      des valeurs positives dans l'intervalle de 0 à 1 incrémentent la phase interne. Une valeur
      d'entrée de 1 forcera toujours <span class="emphasis"><em>partikkel</em></span> à générer un grain. Si la
      valeur reste à 1, l'horloge interne du distributeur de grain marquera une pause mais tous les
      grains en cours d'exécution continueront jusqu'à leur terme.
    </p>
        <p>
      <span class="emphasis"><em>kdistribution</em></span> -- distribution périodique ou stochastique des grains,
      0 = périodique. Le déplacement stochastique de grain est de l'ordre de
      <span class="emphasis"><em>kdistribution</em></span>/<span class="emphasis"><em>grainrate</em></span> secondes. Le
      profil de la distribution stochastique (distribution aléatoire) peut être fixé
      dans la table <span class="emphasis"><em>idisttab</em></span>. Si <span class="emphasis"><em>kdistribution</em></span>
      est négatif, le résultat est un déplacement temporel déterministe comme décrit par
      <span class="emphasis"><em>idisttab</em></span> (lecture séquentielle des valeurs de déplacement). Le
      déplacement de grain maximum est limité dans tous les cas à 10 secondes, et un grain
      conservera les valeurs (durée, hauteur, etc) reçues lors de sa première génération
      (avant le déplacement temporel). Comme le déplacement de grain dépend du taux de
      grains, ce déplacement est indéfini pour un taux de grain de 0Hz et
      <span class="emphasis"><em>kdistribution</em></span> est complètement désactivé dans ce cas.
    </p>
        <p>
      <span class="emphasis"><em>kenv2amt</em></span> -- dosage de l'enveloppe secondaire dans l'enveloppe de
      chaque grain. L'intervalle va de 0 à 1, où 0 signifie pas d'enveloppe secondaire (fenêtre
      rectangulaire), 0,5 provoquera une interpolation entre une fenêtre rectangulaire et la
      forme fixée par <span class="emphasis"><em>ienv2tab</em></span>.
    </p>
        <p>
      <span class="emphasis"><em>ksustain_amount</em></span> -- durée d'entretien exprimée comme une fraction de la
      durée du grain. C-à-d la proportion entre le temps d'enveloppe (attaque + chute) et le temps
      d'entretien. Le niveau d'entretien est celui de la dernière valeur de la ftable
      <span class="emphasis"><em>ienv_attack</em></span>.
    </p>
        <p>
      <span class="emphasis"><em>ka_d_ratio</em></span> -- proportion entre le temps d'attaque et le temps de chute.
      Par exemple, avec <span class="emphasis"><em>ksustain_amount</em></span> à 0,5 et <span class="emphasis"><em>ka_d_ratio</em></span>
      à 0,5, l'eveloppe d'attaque de chaque grain prendra 25% de la durée du grain, l'amplitude
      maximale (entretien) sera tenue pendant 50% de la durée du grain, et l'enveloppe de chute
      prendra les 25% restants de la durée du grain.
    </p>
        <p>
      <span class="emphasis"><em>kduration</em></span> -- durée du grain en millisecondes.
    </p>
        <p>
      <span class="emphasis"><em>kamp</em></span> -- facteur de pondération de l'amplitude en sortie de l'opcode.
      Multiplié par l'amplitude de chaque grain lue à partir de <span class="emphasis"><em>igainmasks</em></span>.
      La lecture de la forme d'onde source dans les grains peut consommer un nombre
      significatif de cycles CPU, spécialement si la durée de grain est longue, de
      nombreux grains se chevauchant. Si <span class="emphasis"><em>kamp</em></span> vaut
      zéro la lecture de la forme d'onde dans les grains n'aura pas lieu (et aucun son
      ne sera évidemment généré). On peut utiliser cette possibilité comme une méthode
      de court-circuit "logiciel" si l'on veut garder l'opcode actif mais silencieux
      pendant un certain temps.
    </p>
        <p>
      <span class="emphasis"><em>kwavfreq</em></span> -- facteur de transposition. Multiplié par les valeurs de
      transposition de départ et de fin lues à partir de <span class="emphasis"><em>iwavfreqstarttab</em></span> et
      de <span class="emphasis"><em>iwavfreqendtab</em></span>.
    </p>
        <p>
      <span class="emphasis"><em>ksweepshape</em></span> -- forme de la progression de la transposition, contrôle la
      courbure de la progression de la transposition. Dans l'intervalle de 0 à 1. Avec les valeurs
      faibles, la transposition sera maintenue plus longtemps près de la valeur de départ
      puis ira rapidement vers la valeur de fin, tandis qu'avec les valeurs fortes la
      transposition ira tout de suite rapidement vers la valeur de fin. Une valeur de 0,5 donnera
      une progression linéaire. La valeur 0 supprimera la progression et ne gardera que la
      fréquence de départ, tandis que la valeur 1 supprimera la progression et ne gardera que la
      fréquence de fin. Le générateur de la progression peut être légèrement imprécis lorsqu'il
      atteint la fréquence finale si l'on utilise une courbe raide avec des grains très longs.
    </p>
        <p>
      <span class="emphasis"><em>awavfm</em></span> -- entrée audio pour la modulation de fréquence du grain.
    </p>
        <p>
      <span class="emphasis"><em>kfmenv</em></span> -- numéro d'une table de fonction, enveloppe du signal modulateur
      de la modulation de fréquence provoquant un changement de l'indice de modulation sur toute la
      durée du grain.
    </p>
        <p>
      <span class="emphasis"><em>ktraincps</em></span> -- fréquence fondamentale des trainlets.
    </p>
        <p>
      <span class="emphasis"><em>knumpartials</em></span> -- nombre de partiels dans les trainlets.
    </p>
        <p>
      <span class="emphasis"><em>kchroma</em></span> -- couleur spectrale des trainlets. Une valeur de 1 donne une
      amplitude égale à chaque partiel, des valeurs plus grandes réduiront l'amplitude des partiels
      inférieurs tout en renforçant l'amplitude des partiels supérieurs.
    </p>
        <p>
      <span class="emphasis"><em>krandommask</em></span> -- masquage aléatoire (escamotage) de grains individuels.
      Dans l'intervalle de 0 à 1, où la valeur 0 signifie pas de masquage (tous les grains sont
      joués), et la valeur 1 escamote tous les grains.
    </p>
        <p>
      <span class="emphasis"><em>kwaveform1</em></span> -- numéro de la table pour la forme d'onde source 1.
     </p>
        <p>
      <span class="emphasis"><em>kwaveform2</em></span> -- numéro de la table pour la forme d'onde source 2.
    </p>
        <p>
      <span class="emphasis"><em>kwaveform3</em></span> -- numéro de la table pour la forme d'onde source 3.
    </p>
        <p>
      <span class="emphasis"><em>kwaveform4</em></span> -- numéro de la table pour la forme d'onde source 4.
    </p>
        <p>
      <span class="emphasis"><em>asamplepos1</em></span> -- position de départ pour la lecture de la forme d'onde
      source 1 (comprise entre 0 et 1).
    </p>
        <p>
      <span class="emphasis"><em>asamplepos2</em></span> -- position de départ pour la lecture de la forme d'onde
      source 2.
    </p>
        <p>
      <span class="emphasis"><em>asamplepos3</em></span> -- position de départ pour la lecture de la forme d'onde
      source 3.
    </p>
        <p>
      <span class="emphasis"><em>asamplepos4</em></span> -- position de départ pour la lecture de la forme d'onde
      source 4.
    </p>
        <p>
      <span class="emphasis"><em>kwavekey1</em></span> -- hauteur originale de la forme d'onde source 1. On peut
      l'utiliser pour transposer chaque forme d'onde source indépendamment.
    </p>
        <p>
      <span class="emphasis"><em>kwavekey2</em></span> -- comme <span class="emphasis"><em>kwavekey1</em></span>, mais pour la forme
      d'onde source 2.
    </p>
        <p>
      <span class="emphasis"><em>kwavekey3</em></span> -- comme <span class="emphasis"><em>kwavekey1</em></span>, mais pour la forme
      d'onde source 3.
    </p>
        <p>
      <span class="emphasis"><em>kwavekey4</em></span> -- comme <span class="emphasis"><em>kwavekey1</em></span>, mais pour la forme
      d'onde source 4.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm47887650082688"></a>
        <h2>Exemples</h2>
        <p>
      Voici un exemple de l'opcode partikkel. Il utilise le fichier
      <a class="ulink" href="examples/partikkel.csd" target="_top"><em class="citetitle">partikkel.csd</em></a>.

      </p>
        <div class="example">
          <a id="idm47887650080816"></a>
          <p class="title">
            <strong>Exemple 631. Exemple de l'opcode partikkel.</strong>
          </p>
          <div class="example-contents">
            <p>Voir les sections <a class="link" href="UsingRealTime.html" title="Audio en temps réel"><em class="citetitle">Audio en Temps Réel</em></a>
        et <a class="link" href="CommandFlags.html" title="Ligne de commande de Csound"><em class="citetitle">Options de la Ligne de Commande</em></a> pour plus
        d'information sur l'utilisation des options de la ligne de commande.</p>
            <div class="refsect1">
              <a id="idm47887511401952"></a>
              <pre class="programlisting">
<span class="csdtag">&lt;CsoundSynthesizer&gt;</span>
<span class="csdtag">&lt;CsOptions&gt;</span>
<span class="comment">; Select audio/midi flags here according to platform</span>
-odac     <span class="comment">;;;realtime audio out</span>
<span class="comment">;-iadc    ;;;uncomment -iadc if real audio input is needed too</span>
<span class="comment">; For Non-realtime ouput leave only the line below:</span>
<span class="comment">; -o partikkel.wav -W ;;; for file output any platform</span>
<span class="csdtag">&lt;/CsOptions&gt;</span>
<span class="csdtag">&lt;CsInstruments&gt;</span>

<span class="ohdr">sr</span> <span class="op">=</span> 44100
<span class="ohdr">ksmps</span> <span class="op">=</span> 20
<span class="ohdr">nchnls</span> <span class="op">=</span> 2

giSine		<span class="ohdr">ftgen</span>	0, 0, 65537, 10, 1
giCosine	<span class="ohdr">ftgen</span>	0, 0, 8193, 9, 1, 1, 90

<span class="oblock">instr</span> 1

kgrainfreq	<span class="op">=</span> 200			<span class="comment">; 4 grains per second</span>
kdistribution	<span class="op">=</span> 0			<span class="comment">; periodic grain distribution</span>
idisttab	<span class="op">=</span> <span class="op">-</span>1			<span class="comment">; (default) flat distribution used for grain distribution</span>
async		<span class="op">=</span> 0			<span class="comment">; no sync input</span>
kenv2amt	<span class="op">=</span> 0			<span class="comment">; no secondary enveloping</span>
ienv2tab	<span class="op">=</span> <span class="op">-</span>1			<span class="comment">; default secondary envelope (flat)</span>
ienv_attack	<span class="op">=</span> <span class="op">-</span>1 <span class="comment">;			; default attack envelope (flat)</span>
ienv_decay	<span class="op">=</span> <span class="op">-</span>1 <span class="comment">;			; default decay envelope (flat)</span>
ksustain_amount	<span class="op">=</span> 0.5			<span class="comment">; time (in fraction of grain dur) at sustain level for each grain</span>
ka_d_ratio	<span class="op">=</span> 0.5 			<span class="comment">; balance between attack and decay time</span>
kduration	<span class="op">=</span> (0.5<span class="op">/</span>kgrainfreq)<span class="op">*</span>1000	<span class="comment">; set grain duration relative to grain rate</span>
kamp		<span class="op">=</span> 5000 			<span class="comment">; amp</span>
igainmasks	<span class="op">=</span> <span class="op">-</span>1			<span class="comment">; (default) no gain masking</span>
kwavfreq	<span class="op">=</span> 440			<span class="comment">; fundamental frequency of source waveform</span>
ksweepshape	<span class="op">=</span> 0			<span class="comment">; shape of frequency sweep (0=no sweep)</span>
iwavfreqstarttab <span class="op">=</span> <span class="op">-</span>1			<span class="comment">; default frequency sweep start (value in table = 1, which give no frequency modification)</span>
iwavfreqendtab	<span class="op">=</span> <span class="op">-</span>1			<span class="comment">; default frequency sweep end (value in table = 1, which give no frequency modification)</span>
awavfm		<span class="op">=</span> 0			<span class="comment">; no FM input</span>
ifmamptab	<span class="op">=</span> <span class="op">-</span>1			<span class="comment">; default FM scaling (=1)</span>
kfmenv		<span class="op">=</span> <span class="op">-</span>1			<span class="comment">; default FM envelope (flat)</span>
icosine		<span class="op">=</span> giCosine		<span class="comment">; cosine ftable</span>
kTrainCps	<span class="op">=</span> kgrainfreq		<span class="comment">; set trainlet cps equal to grain rate for single-cycle trainlet in each grain</span>
knumpartials	<span class="op">=</span> 3			<span class="comment">; number of partials in trainlet</span>
kchroma		<span class="op">=</span> 1			<span class="comment">; balance of partials in trainlet</span>
ichannelmasks	<span class="op">=</span> <span class="op">-</span>1			<span class="comment">; (default) no channel masking, all grains to output 1</span>
krandommask	<span class="op">=</span> 0			<span class="comment">; no random grain masking</span>
kwaveform1	<span class="op">=</span> giSine		<span class="comment">; source waveforms</span>
kwaveform2	<span class="op">=</span> giSine		<span class="comment">;</span>
kwaveform3	<span class="op">=</span> giSine		<span class="comment">;</span>
kwaveform4	<span class="op">=</span> giSine		<span class="comment">;</span>
iwaveamptab	<span class="op">=</span> <span class="op">-</span>1			<span class="comment">; (default) equal mix of all 4 sourcve waveforms and no amp for trainlets</span>
asamplepos1	<span class="op">=</span> 0			<span class="comment">; phase offset for reading source waveform</span>
asamplepos2	<span class="op">=</span> 0			<span class="comment">;</span>
asamplepos3	<span class="op">=</span> 0			<span class="comment">;</span>
asamplepos4	<span class="op">=</span> 0			<span class="comment">;</span>
kwavekey1	<span class="op">=</span> 1			<span class="comment">; original key for source waveform</span>
kwavekey2	<span class="op">=</span> 1			<span class="comment">;</span>
kwavekey3	<span class="op">=</span> 1			<span class="comment">;</span>
kwavekey4	<span class="op">=</span> 1			<span class="comment">;</span>
imax_grains	<span class="op">=</span> 100			<span class="comment">; max grains per k period</span>

asig	<span class="opc">partikkel</span> kgrainfreq, kdistribution, idisttab, async, kenv2amt, ienv2tab, \
               ienv_attack, ienv_decay, ksustain_amount, ka_d_ratio, kduration, kamp, igainmasks, \
               kwavfreq, ksweepshape, iwavfreqstarttab, iwavfreqendtab, awavfm, \
               ifmamptab, kfmenv, icosine, kTrainCps, knumpartials, \
               kchroma, ichannelmasks, krandommask, kwaveform1, kwaveform2, kwaveform3, kwaveform4, \
               iwaveamptab, asamplepos1, asamplepos2, asamplepos3, asamplepos4, \
               kwavekey1, kwavekey2, kwavekey3, kwavekey4, imax_grains

<span class="opc">outs</span>	asig, asig
<span class="oblock">endin</span>

<span class="csdtag">&lt;/CsInstruments&gt;</span>
<span class="csdtag">&lt;CsScore&gt;</span>
<span class="stamnt">i</span>1 0 5 	<span class="comment">; partikkel</span>
<span class="stamnt">e</span>
<span class="csdtag">&lt;/CsScore&gt;</span>
<span class="csdtag">&lt;/CsoundSynthesizer&gt;</span>
</pre>
            </div>
          </div>
        </div>
        <p><br class="example-break" />
    </p>
        <p>
      Voici un autre exemple de l'opcode partikkel. Il utilise le fichier
      <a class="ulink" href="examples/partikkel-2.csd" target="_top"><em class="citetitle">partikkel-2.csd</em></a>.

      </p>
        <div class="example">
          <a id="idm47887650075424"></a>
          <p class="title">
            <strong>Exemple 632. Exemple 2 de l'opcode partikkel.</strong>
          </p>
          <div class="example-contents">
            <div class="refsect1">
              <a id="idm47887511102048"></a>
              <pre class="programlisting">
<span class="csdtag">&lt;CsoundSynthesizer&gt;</span>
<span class="csdtag">&lt;CsOptions&gt;</span>
<span class="comment">; Select audio/midi flags here according to platform</span>
<span class="comment">; Audio out  </span>
-odac           <span class="comment">;;;RT audio </span>
<span class="comment">; For Non-realtime ouput leave only the line below:</span>
<span class="comment">; -o partikkel.wav -W ;;; for file output any platform</span>
<span class="csdtag">&lt;/CsOptions&gt;</span>
<span class="csdtag">&lt;CsInstruments&gt;</span>

<span class="ohdr">sr</span> <span class="op">=</span> 44100
<span class="ohdr">ksmps</span> <span class="op">=</span> 20
<span class="ohdr">nchnls</span> <span class="op">=</span> 2

<span class="comment">; Example by Joachim Heintz and Oeyvind Brandtsegg 2008</span>

giCosine	<span class="ohdr">ftgen</span>	0, 0, 8193, 9, 1, 1, 90		<span class="comment">; cosine</span>
giDisttab	<span class="ohdr">ftgen</span>	0, 0, 32768, 7, 0, 32768, 1	<span class="comment">; for kdistribution</span>
giFile		<span class="ohdr">ftgen</span>	0, 0, 0, 1, "fox.wav", 0, 0, 0	<span class="comment">; soundfile for source waveform</span>
giWin		<span class="ohdr">ftgen</span>	0, 0, 4096, 20, 9, 1		<span class="comment">; grain envelope</span>
giPan		<span class="ohdr">ftgen</span>	0, 0, 32768, <span class="op">-</span>21, 1		<span class="comment">; for panning (random values between 0 and 1)</span>


<span class="comment">; *************************************************</span>
<span class="comment">; partikkel example, processing of soundfile</span>
<span class="comment">; uses the file "fox.wav" </span>
<span class="comment">; *************************************************</span>
		<span class="oblock">instr</span> 1

<span class="op">/</span><span class="op">*</span>score parameters<span class="op">*</span><span class="op">/</span>
ispeed			<span class="op">=</span> p4		<span class="comment">; 1 = original speed </span>
igrainrate		<span class="op">=</span> p5		<span class="comment">; grain rate</span>
igrainsize		<span class="op">=</span> p6		<span class="comment">; grain size in ms</span>
icent			<span class="op">=</span> p7		<span class="comment">; transposition in cent</span>
iposrand		<span class="op">=</span> p8		<span class="comment">; time position randomness (offset) of the pointer in ms</span>
icentrand		<span class="op">=</span> p9		<span class="comment">; transposition randomness in cents</span>
ipan			<span class="op">=</span> p10		<span class="comment">; panning narrow (0) to wide (1)</span>
idist			<span class="op">=</span> p11		<span class="comment">; grain distribution (0=periodic, 1=scattered)</span>

<span class="op">/</span><span class="op">*</span>get length of source wave file, needed for both transposition and time pointer<span class="op">*</span><span class="op">/</span>
ifilen			<span class="opc">tableng</span>	giFile
ifildur			<span class="op">=</span> ifilen <span class="op">/</span> <span class="ohdr">sr</span>

<span class="op">/</span><span class="op">*</span>sync input (disabled)<span class="op">*</span><span class="op">/</span>
async			<span class="op">=</span> 0		

<span class="op">/</span><span class="op">*</span><span class="opc">grain</span> envelope<span class="op">*</span><span class="op">/</span>
kenv2amt		<span class="op">=</span> 1		<span class="comment">; use only secondary envelope</span>
ienv2tab 		<span class="op">=</span> giWin		<span class="comment">; grain (secondary) envelope</span>
ienv_attack		<span class="op">=</span> <span class="op">-</span>1 		<span class="comment">; default attack envelope (flat)</span>
ienv_decay		<span class="op">=</span> <span class="op">-</span>1 		<span class="comment">; default decay envelope (flat)</span>
ksustain_amount		<span class="op">=</span> 0.5		<span class="comment">; no meaning in this case (use only secondary envelope, ienv2tab)</span>
ka_d_ratio		<span class="op">=</span> 0.5 		<span class="comment">; no meaning in this case (use only secondary envelope, ienv2tab)</span>

<span class="op">/</span><span class="op">*</span>amplitude<span class="op">*</span><span class="op">/</span>
kamp			<span class="op">=</span> 0.4<span class="op">*</span><span class="ohdr">0dbfs</span>	<span class="comment">; grain amplitude</span>
igainmasks		<span class="op">=</span> <span class="op">-</span>1		<span class="comment">; (default) no gain masking</span>

<span class="op">/</span><span class="op">*</span>transposition<span class="op">*</span><span class="op">/</span>
kcentrand		<span class="opc">rand</span> icentrand	<span class="comment">; random transposition</span>
iorig			<span class="op">=</span> 1 <span class="op">/</span> ifildur	<span class="comment">; original pitch</span>
kwavfreq		<span class="op">=</span> iorig <span class="op">*</span> <span class="opc">cent</span>(icent <span class="op">+</span> kcentrand)

<span class="op">/</span><span class="op">*</span>other <span class="opc">pitch</span> related (disabled)<span class="op">*</span><span class="op">/</span>
ksweepshape		<span class="op">=</span> 0		<span class="comment">; no frequency sweep</span>
iwavfreqstarttab 	<span class="op">=</span> <span class="op">-</span>1		<span class="comment">; default frequency sweep start</span>
iwavfreqendtab		<span class="op">=</span> <span class="op">-</span>1		<span class="comment">; default frequency sweep end</span>
awavfm			<span class="op">=</span> 0		<span class="comment">; no FM input</span>
ifmamptab		<span class="op">=</span> <span class="op">-</span>1		<span class="comment">; default FM scaling (=1)</span>
kfmenv			<span class="op">=</span> <span class="op">-</span>1		<span class="comment">; default FM envelope (flat)</span>

<span class="op">/</span><span class="op">*</span>trainlet related (disabled)<span class="op">*</span><span class="op">/</span>
icosine			<span class="op">=</span> giCosine	<span class="comment">; cosine ftable</span>
kTrainCps		<span class="op">=</span> igrainrate	<span class="comment">; set trainlet cps equal to grain rate for single-cycle trainlet in each grain</span>
knumpartials		<span class="op">=</span> 1		<span class="comment">; number of partials in trainlet</span>
kchroma			<span class="op">=</span> 1		<span class="comment">; balance of partials in trainlet</span>

<span class="op">/</span><span class="op">*</span>panning, using channel masks<span class="op">*</span><span class="op">/</span>
imid			<span class="op">=</span> .5<span class="comment">; center</span>
ileftmost		<span class="op">=</span> imid <span class="op">-</span> ipan<span class="op">/</span>2
irightmost		<span class="op">=</span> imid <span class="op">+</span> ipan<span class="op">/</span>2
giPanthis		<span class="ohdr">ftgen</span>	0, 0, 32768, <span class="op">-</span>24, giPan, ileftmost, irightmost	<span class="comment">; rescales giPan according to ipan</span>
			<span class="opc">tableiw</span>		0, 0, giPanthis				<span class="comment">; change index 0 ...</span>
			<span class="opc">tableiw</span>		32766, 1, giPanthis			<span class="comment">; ... and 1 for ichannelmasks</span>
ichannelmasks		<span class="op">=</span> giPanthis		<span class="comment">; ftable for panning</span>

<span class="op">/</span><span class="op">*</span><span class="opc">random</span> <span class="opc">gain</span> masking (disabled)<span class="op">*</span><span class="op">/</span>
krandommask		<span class="op">=</span> 0	

<span class="op">/</span><span class="op">*</span>source waveforms<span class="op">*</span><span class="op">/</span>
kwaveform1		<span class="op">=</span> giFile	<span class="comment">; source waveform</span>
kwaveform2		<span class="op">=</span> giFile	<span class="comment">; all 4 sources are the same</span>
kwaveform3		<span class="op">=</span> giFile
kwaveform4		<span class="op">=</span> giFile
iwaveamptab		<span class="op">=</span> <span class="op">-</span>1		<span class="comment">; (default) equal mix of source waveforms and no amplitude for trainlets</span>

<span class="op">/</span><span class="op">*</span>time pointer<span class="op">*</span><span class="op">/</span>
afilposphas		<span class="opc">phasor</span> ispeed <span class="op">/</span> ifildur
<span class="op">/</span><span class="op">*</span>generate <span class="opc">random</span> deviation of the time pointer<span class="op">*</span><span class="op">/</span>
iposrandsec		<span class="op">=</span> iposrand <span class="op">/</span> 1000	<span class="comment">; ms -&gt; sec</span>
iposrand		<span class="op">=</span> iposrandsec <span class="op">/</span> ifildur	<span class="comment">; phase values (0-1)</span>
krndpos			<span class="opc">linrand</span>	 iposrand	<span class="comment">; random offset in phase values</span>
<span class="op">/</span><span class="op">*</span>add <span class="opc">random</span> deviation to the time pointer<span class="op">*</span><span class="op">/</span>
asamplepos1		<span class="op">=</span> afilposphas <span class="op">+</span> krndpos<span class="comment">; resulting phase values (0-1)</span>
asamplepos2		<span class="op">=</span> asamplepos1
asamplepos3		<span class="op">=</span> asamplepos1	
asamplepos4		<span class="op">=</span> asamplepos1	

<span class="op">/</span><span class="op">*</span>original key for each source waveform<span class="op">*</span><span class="op">/</span>
kwavekey1		<span class="op">=</span> 1
kwavekey2		<span class="op">=</span> kwavekey1	
kwavekey3		<span class="op">=</span> kwavekey1
kwavekey4		<span class="op">=</span> kwavekey1

<span class="op">/</span><span class="op">*</span> maximum number of grains per <span class="opc">k</span><span class="op">-</span>period<span class="op">*</span><span class="op">/</span>
imax_grains		<span class="op">=</span> 100		

aL, aR		<span class="opc">partikkel</span> igrainrate, idist, giDisttab, async, kenv2amt, ienv2tab, \
		ienv_attack, ienv_decay, ksustain_amount, ka_d_ratio, igrainsize, kamp, igainmasks, \
		kwavfreq, ksweepshape, iwavfreqstarttab, iwavfreqendtab, awavfm, \
		ifmamptab, kfmenv, icosine, kTrainCps, knumpartials, \
		kchroma, ichannelmasks, krandommask, kwaveform1, kwaveform2, kwaveform3, kwaveform4, \
		iwaveamptab, asamplepos1, asamplepos2, asamplepos3, asamplepos4, \
		kwavekey1, kwavekey2, kwavekey3, kwavekey4, imax_grains

		<span class="opc">outs</span>			aL, aR

<span class="oblock">endin</span>


<span class="csdtag">&lt;/CsInstruments&gt;</span>
<span class="csdtag">&lt;CsScore&gt;</span>
<span class="comment">;i1	st	dur	speed	grate	gsize	cent	posrnd	cntrnd	pan	dist</span>
<span class="stamnt">i</span>1	0	2.757	1	200	15	0	0	0	0	0
<span class="stamnt">s</span>
<span class="stamnt">i</span>1	0	2.757	1	200	15	400	0	0	0	0
<span class="stamnt">s</span>
<span class="stamnt">i</span>1	0	2.757	1	15	450	400	0	0	0	0
<span class="stamnt">s</span>
<span class="stamnt">i</span>1	0	2.757	1	15	450	400	0	0	0	0.4
<span class="stamnt">s</span>
<span class="stamnt">i</span>1	0	2.757	1	200	15	0	400	0	0	1
<span class="stamnt">s</span>
<span class="stamnt">i</span>1	0	5.514	.5	200	20	0	0	600	.5	1
<span class="stamnt">s</span>
<span class="stamnt">i</span>1	0	11.028	.25	200	15	0	1000	400	1	1


<span class="csdtag">&lt;/CsScore&gt;</span>
<span class="csdtag">&lt;/CsoundSynthesizer&gt;</span>
</pre>
            </div>
          </div>
        </div>
        <p><br class="example-break" />
    </p>
      </div>
      <div class="refsect1">
        <a id="idm47887650073504"></a>
        <h2>Voir aussi</h2>
        <p><a class="link" href="fof.html" title="fof"><em class="citetitle">fof</em></a>,
      <a class="link" href="fof2.html" title="fof2"><em class="citetitle">fof2</em></a>,
      <a class="link" href="fog.html" title="fog"><em class="citetitle">fog</em></a>,
      <a class="link" href="grain.html" title="grain"><em class="citetitle">grain</em></a>,
      <a class="link" href="grain2.html" title="grain2"><em class="citetitle">grain2</em></a>,
      <a class="link" href="grain3.html" title="grain3"><em class="citetitle">grain3</em></a>,
      <a class="link" href="granule.html" title="granule"><em class="citetitle">granule</em></a>,
      <a class="link" href="sndwarp.html" title="sndwarp"><em class="citetitle">sndwarp</em></a>,
      <a class="link" href="sndwarpst.html" title="sndwarpst"><em class="citetitle">sndwarpst</em></a>,
      <a class="link" href="syncgrain.html" title="syncgrain"><em class="citetitle">syncgrain</em></a>,
      <a class="link" href="syncloop.html" title="syncloop"><em class="citetitle">syncloop</em></a>,
      <a class="link" href="partikkelsync.html" title="partikkelsync"><em class="citetitle">partikkelsync</em></a>
    </p>
      </div>
      <div class="refsect1">
        <a id="idm47887650061152"></a>
        <h2>Crédits</h2>
        <p>
      </p>
        <table border="0" summary="Simple list" class="simplelist">
          <tr>
            <td>Auteur : Thom Johansen</td>
          </tr>
          <tr>
            <td>Auteur : Torgeir Strand Henriksen</td>
          </tr>
          <tr>
            <td>Auteur : Øyvind Brandtsegg</td>
          </tr>
          <tr>
            <td>Avril 2007</td>
          </tr>
        </table>
        <p>
    </p>
        <p>Exemples écrits par Joachim Heintz et Øyvind Brandtsegg.</p>
        <p>
    </p>
        <p>Nouveau dans la version 5.06</p>
        <p>
    </p>
      </div>
    </div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="partials.html">Précédent</a> </td>
          <td width="20%" align="center">
            <a accesskey="u" href="OpcodesTop.html">Niveau supérieur</a>
          </td>
          <td width="40%" align="right"> <a accesskey="n" href="partikkelsync.html">Suivant</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">partials </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Sommaire</a>
          </td>
          <td width="40%" align="right" valign="top"> partikkelsync</td>
        </tr>
      </table>
    </div>
  </body>
</html>
